	<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.14" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title> Server algorithm &middot; Etzel Server </title>

  
  <link rel="stylesheet" href="http://etzelserver.com/css/poole.css">
  <link rel="stylesheet" href="http://etzelserver.com/css/syntax.css">
  <link rel="stylesheet" href="http://etzelserver.com/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="Etzel Server" />


<link rel="stylesheet" href="/prism/themes/prism.css">
<script src="/prism/prism.js"></script>


</head>

	<body class="">
		<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="http://etzelserver.com/"><h1>Etzel Server</h1></a>
      <p class="lead">
      A Fast & Reliable open source Job delegation & queueing server written in Erlang/OTP. Follow us on <a href="http://twitter.com/etzelserver">@EtzelServer</a>.
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="/">Home</a> </li>
      
        <li><a href="/getstarted/"> Getting started </a></li>
      
        <li><a href="/documentation/"> Documentation </a></li>
      
        <li><a href="/lang-drivers/"> Language Drivers </a></li>
      
        <li><a href="/about/"> About Etzel </a></li>
      
    </ul>

    <p>&copy; 2015. All rights reserved. </p>
  </div>
</div>


		<div class="content container">
			<div class="post">
			 	<h1>Server algorithm</h1>
			  <span style="display:none" class="post-date">Sat, Aug 22, 2015</span>
			      <nav>
<ul>
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#on-subscribe:7abec6c6330e8dbe3e8f868b38416272">ON_SUBSCRIBE:</a></li>
<li><a href="#on-publish:7abec6c6330e8dbe3e8f868b38416272">ON_PUBLISH:</a></li>
<li><a href="#on-fet-request:7abec6c6330e8dbe3e8f868b38416272">ON_FET_REQUEST:</a></li>
<li><a href="#on-ack-del-request:7abec6c6330e8dbe3e8f868b38416272">ON_ACK/DEL_REQUEST:</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>

<h6 id="on-subscribe:7abec6c6330e8dbe3e8f868b38416272">ON_SUBSCRIBE:</h6>

<ul>
<li>Spawn a process for client &amp; attach its PID to the group.</li>
<li>Example: join_group(Qname,PID)</li>
</ul>

<h6 id="on-publish:7abec6c6330e8dbe3e8f868b38416272">ON_PUBLISH:</h6>

<ul>
<li>IF NO DELAY -&gt; CALL PUBLISH();</li>
<li>Else:

<ul>
<li>CALL PUBLISH(); with delay</li>
<li>write this info(key:value) to disk</li>
</ul></li>
</ul>

<pre><code>PUBLISH()
   - Broadcast Awake Signal to all processes in the sleep list.
   - &amp; Remove those processes from the sleep list.
   - Spawn a process for the Queue-X if it does not exist
   - &amp; send the Element to this process.
   - Now this Queue-X Process will accept the element
   - &amp; also write(async) the data to disk by generating required key:value  
</code></pre>

<h6 id="on-fet-request:7abec6c6330e8dbe3e8f868b38416272">ON_FET_REQUEST:</h6>

<pre><code>   1. Pop the top of the Queue 
   2. if the element has expired 
        2.1 Delete element from disk
        2.2 go to step 1
   3. if the element matches with any element in the delete list: 
      3.1. remove the element from the delete list.
      3.2. Go to Step 1
   3. else Send it to the requested Client 
   4. increment the 'error_count' of the Element on Disk
   5. CALL PUBLISH(element); WITH DELAY:60
</code></pre>

<h6 id="on-ack-del-request:7abec6c6330e8dbe3e8f868b38416272">ON_ACK/DEL_REQUEST:</h6>

<ul>
<li>Delete the element from disk</li>
<li>PUSH the element to the delete list</li>
</ul>

			</div>

			
		</div>

  </body>
</html>
